[pytest]
# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Custom markers
markers =
    smoke: mark test as smoke test for critical functionality
    regression: mark test as regression test
    database: mark test as database integration test
    api: mark test as API test
    visual: mark test as visual regression test
    slow: mark test as slow running test (>30s)
    integration: mark test as integration test
    unit: mark test as unit test
    performance: mark test as performance test
    advanced: mark test as advanced functionality test
    framework: mark test as framework functionality test
    security: mark test as security test
    parallel: mark test as safe for parallel execution
    serial: mark test as requiring serial execution
    browser_chrome: mark test as Chrome browser specific
    browser_firefox: mark test as Firefox browser specific
    browser_edge: mark test as Edge browser specific
    environment_local: mark test for local environment only
    environment_ci: mark test for CI environment only
    priority_high: mark test as high priority
    priority_medium: mark test as medium priority
    priority_low: mark test as low priority
    playwright: mark test as Playwright browser test
    asyncio: mark test as async test

# Asyncio configuration
asyncio_mode = auto

# Default options
addopts = 
    --verbose
    --strict-markers
    --strict-config
    --tb=short
    --showlocals
    --durations=10
    --html=reports/test_report.html
    --self-contained-html
    --junitxml=reports/junit.xml
    --json-report
    --json-report-file=reports/json_report.json
    --alluredir=reports/allure-results
    --cov=pages
    --cov=utils
    --cov=config
    --cov-report=html:reports/coverage_html
    --cov-report=xml:reports/coverage.xml
    --cov-report=term-missing
    --capture=no

# Logging configuration
log_cli = true
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

log_file = logs/pytest.log
log_file_level = DEBUG
log_file_format = %(asctime)s [%(levelname)8s] %(filename)s:%(lineno)d %(funcName)s(): %(message)s
log_file_date_format = %Y-%m-%d %H:%M:%S

# Warning filters
filterwarnings =
    ignore::UserWarning
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    error::pytest.PytestUnraisableExceptionWarning

# Minimum version requirements
minversion = 8.0